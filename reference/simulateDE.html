<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A simple DE simulator that takes a dataset with a grouping factor and induces
DE by swapping some features in one of the groups but not the other. This
should ensure keeping the same data structure as the original data without
having to estimate distribution parameters."><title>Simulate DE by swapping features — simulateDE • swapper</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate DE by swapping features — simulateDE"><meta property="og:description" content="A simple DE simulator that takes a dataset with a grouping factor and induces
DE by swapping some features in one of the groups but not the other. This
should ensure keeping the same data structure as the original data without
having to estimate distribution parameters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">swapper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/swapper.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/milanmlft/swapper/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate DE by swapping features</h1>
      <small class="dont-index">Source: <a href="https://github.com/milanmlft/swapper/blob/HEAD/R/simulateDE.R" class="external-link"><code>R/simulateDE.R</code></a></small>
      <div class="d-none name"><code>simulateDE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A simple DE simulator that takes a dataset with a grouping factor and induces
DE by swapping some features in one of the groups but not the other. This
should ensure keeping the same data structure as the original data without
having to estimate distribution parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateDE</span><span class="op">(</span><span class="va">x</span>, <span class="va">which_cols</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY</span></span>
<span><span class="fu">simulateDE</span><span class="op">(</span><span class="va">x</span>, <span class="va">which_cols</span>, prop_DE <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SummarizedExperiment</span></span>
<span><span class="fu">simulateDE</span><span class="op">(</span><span class="va">x</span>, <span class="va">which_cols</span>, <span class="va">...</span>, use_assay <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SingleCellExperiment</span></span>
<span><span class="fu">simulateDE</span><span class="op">(</span><span class="va">x</span>, <span class="va">which_cols</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A numeric matrix containing features in rows and cells in columns.
Alternatively, a SummarizedExperiment or
SingleCellExperiment object.</p></dd>


<dt>which_cols</dt>
<dd><p>Character, numeric or logical vector specifying for which
columns (cells, samples, ...) of <code>x</code> the feature swapping should occur.
Usually, this will be a random subset of columns belonging to a mock group.</p></dd>


<dt>...</dt>
<dd><p>For the generic, arguments to be passed to specific methods.</p>
<p>For the <code>SummarizedExperiment</code> method, further arguments to be passed to
the <code>ANY</code> method.</p>
<p>For the <code>SingleCellExperiment</code> method, further arguments to be passed to
the <code>SummarizedExperiment</code> method.</p></dd>


<dt>prop_DE</dt>
<dd><p>Numeric scalar specifying the proportion of features that will
be simulated as DE. Default: <code>0.01</code>.</p></dd>


<dt>use_assay</dt>
<dd><p>A string or integer scalar specifying the assay of <code>x</code> to be
used as input for the simulation. The default is to use <code>"counts"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A SummarizedExperiment object with DE induced between the
specified <code>groups</code>. The simulated counts are in the <code>"counts"</code> assay of the
returned object. The <code>"sim_group"</code> column of the <code>colData</code> indicates whether
swapping was performed in that column (specified by the <code>which_cols</code></p>


<p>argument). The <code>rowData</code> contains the
following columns:</p><ul><li><p><code>"is_DE"</code>: logical vector indicating the ground truth status of each
feature</p></li>
<li><p><code>"swapped_feature"</code>: character vector indicating the original feature with
which the feature was swapped</p></li>
</ul><p>If <code>x</code> was a <em>SummarizedExperiment</em> object, the original <code>colData</code> and
<code>rowData</code> are combined with these new columns.</p>


<p>If <code>x</code> was a <em>SingleCellExperiment</em> object, the output will also be a
<em>SingleCellExperiment</em>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that for <em>SummarizedExperiment</em> objects, any additional assays
(containing for example normalized values) are not retained. For simple
library size-factor normalization, size factors for each cell will be
identical before and after simulation. However, for more sophisticated
methods, such as normalization by deconvolution, the size factors might
differ due to the feature swapping.
The expected number of DE features will be equal to <code>prop_DE * nrow(x)</code>. Note
however that it's possible that the actual number might be 1 lower than this.
This can happen when a single feature remains un-"swapped" without any other
features left to swap it with.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Milan Malfait</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">example_sce</span> <span class="op">&lt;-</span> <span class="fu">scuttle</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/mockSCE.html" class="external-link">mockSCE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Swap features in the "treat1" group</span></span></span>
<span class="r-in"><span><span class="va">cells_to_swap</span> <span class="op">&lt;-</span> <span class="va">example_sce</span><span class="op">$</span><span class="va">Treatment</span> <span class="op">==</span> <span class="st">"treat1"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simulateDE</span><span class="op">(</span><span class="va">example_sce</span>, which_cols <span class="op">=</span> <span class="va">cells_to_swap</span>, prop_DE <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SingleCellExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 2000 200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(2000): Gene_0001 Gene_0002 ... Gene_1999 Gene_2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(2): is_DE swapped_feature</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(200): Cell_001 Cell_002 ... Cell_199 Cell_200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(4): Mutation_Status Cell_Cycle Treatment sim_group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Milan Malfait.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

